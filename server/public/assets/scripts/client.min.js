/*! mygigs 2016-02-12 */
var app=angular.module("myGigsApp",["ngRoute","ngCookies"]);app.directive("formatDate",function(){return{require:"ngModel",link:function(a,b,c,d){d.$formatters.push(function(a){return new Date(a)})}}}),app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/home.html",controller:"HomeController"}).when("/home",{templateUrl:"views/home.html",controller:"HomeController"}).when("/newGig",{templateUrl:"views/newGig.html",controller:"newGigController"}).when("/detailedGig",{templateUrl:"views/detailedGig.html",controller:"detailedGigController"}),b.html5Mode(!0)}]),app.controller("HomeController",["$scope","$http","$location","GigService",function(a,b,c,d){a.data=[];var e=function(){b.get("/getAllGigs").then(function(b){a.gigs=b.data})};a.deleteSelectedGigs=function(){for(var c=0;c<a.gigs.length;c++)a.gigs[c].selected&&b["delete"]("/gigDelete"+a.gigs[c]._id).then(e)},e(),a.viewSelectedGigs=function(){function b(){for(var b=0,c=0;c<a.gigs.length;c++)a.gigs[c].selected&&b++;return b}console.log("This is the gig id");var e=b();if(0==e)alert("Please select one gig to view its details.");else if(e>1)alert("Please select one gig at a time to view its details.");else for(var f=0;f<a.gigs.length;f++)a.gigs[f].selected&&(d.setSelectedGig(a.gigs[f]),console.log(d.getSelectedGig()),c.path("detailedGig"))}}]),app.controller("newGigController",["$scope","$http","$location","GigService",function(a,b,c,d){a.saveData=function(){console.log(a.data);var b=document.forms.form.group.value;return null==b||""==b?(alert("Please type at least the Group Name."),!1):void d.postGigs(a.data)}}]),app.controller("detailedGigController",["$scope","$http","$location","GigService","$cookies",function(a,b,c,d,e){a.data=d.getSelectedGig(),a.viewSelectedGigs=function(){console.log("This is the gig id");for(var b=0;b<a.gigs.length;b++)a.gigs[i].selected&&d.setSelectedGig(a.gig[i].selected)},a.updateData=function(){console.log(a.data),b.post("/updateGig",a.data).then(function(a){200===a.status?c.path("/home"):console.log("error")})}}]),app.factory("GigService",["$http","$location","$cookies",function(a,b,c){function d(a){g=a,c.put("selection",JSON.stringify(a))}function e(){return JSON.parse(c.get("selection"))}var f={},g={},h=function(c){a.post("/addGig",c).then(function(a){200===a.status?b.path("/home"):console.log("error")})};return{data:f,postGigs:h,setSelectedGig:d,getSelectedGig:e,selectedGig:g}}]);